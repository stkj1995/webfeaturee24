---
import MainLayout from "../layouts/MainLayout.astro"; 
import Button from '../components/Button.astro'; 
import Link from '../components/Link.astro'; 
import { Image } from 'astro:assets'; 
import apoteket from "../assets/images/apoteket.jpg"; 
import arbejde from "../assets/images/arbejde.jpg"; 
import glitch from "../assets/images/glitch.jpg"; 
import godtarbejde from "../assets/images/godt-arbejde.jpg"; 
import lidtifem from "../assets/images/lidtifem-pierre-falcke.jpg"; 
import smena from "../assets/images/lomo-smena-17.jpg"; 
import overouticm from "../assets/images/over-out-icm.jpeg"; 
import pierre from "../assets/images/pierre.jpeg"; 
import tyndfilm from "../assets/images/tynd-film.jpg"; 
import "../styles/tobii.min.css"; 
import { animate, scroll, inView as motionInView, timeline } from '@motionone/dom';
import type { TimelineSegment } from '@motionone/dom'; 
---
<script src="https://cdn.jsdelivr.net/npm/@motionone/dom@latest/dist/motion-one.min.js"></script>


<MainLayout title="Surprise og Delight">
    <style>
        body {
            cursor: url('/src/assets/images/custom-cursor.png'), auto;
        }
    </style> 
<div x-data="{ scrollPos: 0, showProgressBar: false, messages: ['Besked 1', 'Besked 2', 'Besked 3'], randomMessage: '' }" @scroll.window="scrollPos = window.scrollY; showProgressBar = scrollPos > 0">
    <div 
        :class="scrollPos > 200 ? 'bg-gradient-to-r from-pink-500 to-yellow-300 text-white' : 'bg-white text-gray-800'" 
        class="transition-all duration-300 min-h-screen mt-16"
    >

        <!-- Progress Bar -->
        <div x-show="showProgressBar" class="progress-container fixed top-0 left-0 w-full h-2 bg-transparent z-50">
            <div class="progress-bar h-full bg-gradient-to-r from-blue-400 to-purple-600" :style="{ transform: 'scaleX(' + (scrollPos / (document.body.scrollHeight - window.innerHeight)) + ')' }"></div>
        </div>

			<section class="max-w-4xl mx-auto mt-52 relative" id="herovideo">
				<video class="w-full rounded-lg shadow-lg" autoplay muted loop>
					<source src="pierre-falcke-video.mp4" type="video/mp4">
				</video>
				<!-- Lydafspiller med loop -->
				<audio id="background-audio" loop>
					<source src="assets/sounds/warm-chords-loop.mp3" type="audio/mpeg">
				</audio>
			
				<!-- Knap til at tænde/slå lyden til/fra -->
				<button id="toggle-sound" class="absolute bottom-5 right-5 bg-gradient-to-r from-green-400 to-blue-600 text-white font-bold py-2 px-4 rounded shadow-lg hover:bg-green-700 transition duration-300 transform hover:scale-105">
					Slå lyd til
				</button>
			</section>      
		
            <section class="max-w-xl mx-auto mt-32 prose" id="manchet">
				<p class="text-xl">Pierre Falcke. Du ved formentligt ikke hvem han er. Men indtil for kort tid siden, så du hans værker et par gange om dagen, hver dag, året rundt. Pierre Falcke var en af verdens bedst sælgende stock-fotografer, og han solgte over 2 millioner fotos om året. Men Pierre kunne ikke drømme om at bruge sine egne fotos - faktisk kan han ikke fordrage sit eget arbejde.</p>
				<div class="mb-6">
					<a href="pierre.jpeg" class="lightbox">
						<Image src={pierre} alt="" class="fotoinview rounded-lg shadow-lg" /> <!-- Tilføjet 'fotoinview' klassen -->
						<figcaption class="mt-2 text-center text-sm italic text-gray-600">Pierre Falcke, selvportræt</figcaption>
					</a>
				</div>
			
				<p class="text-2xl italic text-center bg-gray-800 p-8 text-white rounded-lg">
					Pierre sælger 2 millioner fotos om året
				</p>
				<p class="text-2xl italic text-center bg-gray-800 p-8 text-white rounded-lg">
					Det svarer til én fotolicens hvert 16. sekund
				</p>
				<p class="text-2xl italic text-center bg-gray-800 p-8 text-white rounded-lg">
					Du ser hans fotos ca. 2 gange om dagen
				</p>
			</section>          

            <!-- Besked-sektion til tilfældige beskeder -->
            <section class="max-w-xl mx-auto mt-32" x-data="{ 
                randomMessage: '', 
                messages: [
                    'Det uperfekte er ofte det mest ægte.',
                    'Fejl er beviser på, at du prøver.',
                    'Skridtene til succes er ofte i usikkerhedens skygge.',
                    'Husk, at hver fejl bringer dig et skridt tættere på succes.',
                    'Livet er en rejse, ikke en destination. Nyd hvert øjeblik!',
                    'Selv de bedste fotografer tager ikke altid perfekte billeder.',
                    'Hvem har brug for perfekte billeder, når du har karakter?',
                    'Uperfekte øjeblikke er ofte de sjoveste!',
                    'Det eneste perfekte billede er det, der gør dig glad.',
                    'Det er de små, uperfekte øjeblikke, der gør livet værd at leve.',
                    'Selv det mest beskedne motiv kan blive til et mesterværk.',
                    'Husk: det handler ikke kun om billedet, men om historien bag.',
                    'Tag et øjeblik til at se skønheden i det uperfekte.',
                    'Hvad inspirerer dig i dag? Del dit øjeblik med os!',
                    'Find skønheden i det enkle og det uventede.'
                ],
                playSound() {
                    this.$refs.trykforatafspillelyd.play();
                }
            }">
                <button 
                    class="bg-gradient-to-r from-blue-400 to-purple-600 text-white font-bold py-3 px-6 rounded shadow-lg hover:bg-blue-700 transition duration-300 transform hover:scale-105" 
                    @click="randomMessage = messages[Math.floor(Math.random() * messages.length)]; playSound()">
                    Klik for perfekt uperfekt besked
                </button>

                <p class="mt-4 mb-10 text-lg text-gray-800 italic" x-text="randomMessage"></p>

                <!-- Lydafspiller -->
                <audio x-ref="trykforatafspillelyd">
                    <source src="/assets/sounds/click-sound.mp3" type="audio/mpeg">
                </audio>
            </section>

            <section class="grid grid-cols-1 md:grid-cols-2 mt-10">
                <div class="bg-gray-800 p-4 shadow-lg">
                    <h3 class="text-2xl font-bold text-white mb-4">Uperfekte billeder</h3>
                    <Image src={overouticm} alt="" class="staggered-image rounded-lg shadow-lg mb-4"/>
                    <Image src={tyndfilm} alt="" class="staggered-image rounded-lg shadow-lg mb-4"/>
                </div>
                <div class="bg-gray-800 p-4 shadow-lg">
                    <h3 class="text-2xl font-bold text-white mb-4">Smena og ICM</h3>
                    <Image src={smena} alt="" class="staggered-image rounded-lg shadow-lg mb-4"/>
                    <Image src={glitch} alt="" class="staggered-image rounded-lg shadow-lg mb-4"/>
                </div>             
            </section>            
        </div>
    </div>
</MainLayout>

<script>
    // Importer Motion One
    import { animate, inView as motionInView, timeline } from '@motionone/dom';
    import type { TimelineSegment } from '@motionone/dom'; // Type-only import
    
        document.addEventListener('DOMContentLoaded', () => {
        // Entrance animation
        const entranceImage = document.querySelector('.entranceanimation');
        const entranceObserver = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    animate(entranceImage, { opacity: 1, y: 0 }, { duration: 1 });
                    entranceObserver.unobserve(entry.target);
                }
            });
        });

        entranceObserver.observe(entranceImage);

        // Timeline animation
        motionInView("#timelineanimationimage", () => {
            const timelineanimation: TimelineSegment[] = [
                [".timelineanimation", { opacity: 1 }, { duration: 1 }], // Forbedret fra 5 til 1 sek.
                [".timelineanimation", { transform: "rotate(360deg)" }, { duration: 3 }],
                [".timelineanimation", { transform: "scale(1.5)" }, { duration: 0.5 }],
                [".timelineanimation", { transform: "scale(1)" }, { duration: 1 }],
                [".timelineanimation", { opacity: 0.3 }, { duration: 5 }]
            ];
            timeline(timelineanimation);
        });
    });        

    document.addEventListener('DOMContentLoaded', () => {
        const audio = document.getElementById('background-audio') as HTMLAudioElement;
        const toggleButton = document.getElementById('toggle-sound') as HTMLButtonElement;
        let isAudioPlaying = false;

        toggleButton.addEventListener('click', () => {
            if (isAudioPlaying) {
                audio.pause();
                toggleButton.textContent = 'Slå Lyd Til';
            } else {
                audio.play().catch((error) => {
                    console.log("Lyden kunne ikke starte:", error);
                });
                toggleButton.textContent = 'Slå lyd fra';
            }
            isAudioPlaying = !isAudioPlaying;
        });

        document.addEventListener('DOMContentLoaded', () => {
    const header = document.getElementById('entrance-header');

    // Initial state for animation
    animate(header, { opacity: 1, y: 0 }, { duration: 1 }); // Sørg for, at headeren vises med det samme
});


        // inView animation
        motionInView(".fotoinview", () => {
            animate(".fotoinview", { x: [-2000, 0] }, { duration: 3 });
        });
    });

    document.addEventListener('DOMContentLoaded', () => {
    // ... eksisterende kode ...

    // Anvend staggered animation på billederne nederst
    const imageElements = document.querySelectorAll('.staggered-image');
    imageElements.forEach((image, index) => {
        motionInView(image, () => {
            animate(
                image,
                { opacity: [0, 1], transform: ['translateY(50px)', 'translateY(0)'] },
                { duration: 1, delay: index * 0.3 } // Forsinkelse baseret på indekset for stagger-effekt
            );
        });
    });
});

    document.addEventListener('DOMContentLoaded', () => {
        // inView animation for header
        motionInView('#entrance-header', ({ target }) => {
            animate(target, { opacity: 1, y: 0 }, { duration: 1 });
        });

        // inView animation for description
        motionInView('#entrance-description', ({ target }) => {
            animate(target, { opacity: 1, y: 0 }, { duration: 1 });
        });
    });
</script>

